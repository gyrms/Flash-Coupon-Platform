# 요구사항 명세서 (Requirements Specification)

## 1. 프로젝트 개요

### 1.1 프로젝트명
**Flash Coupon Platform** - 선착순 쿠폰 발급 및 실시간 알림 시스템

### 1.2 목적
대용량 트래픽 환경에서 안정적인 선착순 쿠폰 발급과 실시간 사용자 알림을 제공하는 범용 플랫폼 개발

### 1.3 적용 도메인
- 이커머스 (올리브영 등)
- 핀테크/보험 (카카오페이손해보험 등)
- 범용 이벤트 플랫폼

### 1.4 개발 배경
- 선착순 이벤트에서 발생하는 동시성 문제 해결
- 대용량 트래픽 처리 경험 축적
- MSA 아키텍처 실전 경험

---

## 2. 성능 요구사항

### 2.1 목표 성능 지표

| 항목 | 목표 |
|------|------|
| 동시 사용자 | 10,000명 |
| 쿠폰 수량 | 1,000개/이벤트 |
| API 응답 시간 | 500ms 이내 (95 percentile) |
| 발급 성공률 | 99% 이상 |
| 알림 지연 시간 | 1초 이내 |
| 시스템 가용성 | 99.9% |

### 2.2 처리량 요구사항
- 초당 요청 처리: 최소 1,000 TPS
- 피크 시간대 처리: 3,000 TPS
- DB 동시 연결: 최대 500개

### 2.3 확장성 요구사항
- 수평 확장 가능한 아키텍처
- Auto Scaling 지원
- 무중단 배포 가능

---

## 3. 기능 요구사항

### 3.1 Phase 1 - 핵심 기능 (필수)

#### 3.1.1 회원 관리
| 기능 ID | 기능명 | 설명 | 우선순위 |
|---------|--------|------|----------|
| F-001 | 회원가입 | 이메일 기반 회원가입 | High |
| F-002 | 로그인 | JWT 기반 인증 | High |
| F-003 | 로그아웃 | 토큰 무효화 | Medium |
| F-004 | 프로필 조회 | 사용자 정보 조회 | Medium |

#### 3.1.2 쿠폰 발급
| 기능 ID | 기능명 | 설명 | 우선순위 |
|---------|--------|------|----------|
| F-101 | 선착순 쿠폰 발급 | Redis 분산 락 기반 동시성 제어 | High |
| F-102 | 1인당 발급 제한 | 동일 이벤트당 최대 3개 | High |
| F-103 | 중복 발급 방지 | 동일 사용자 중복 체크 | High |
| F-104 | 쿠폰 코드 생성 | 유니크한 쿠폰 코드 자동 생성 | High |
| F-105 | 재고 관리 | 실시간 발급 가능 수량 체크 | High |

#### 3.1.3 쿠폰 조회
| 기능 ID | 기능명 | 설명 | 우선순위 |
|---------|--------|------|----------|
| F-201 | 내 쿠폰함 조회 | 발급받은 쿠폰 목록 | High |
| F-202 | 쿠폰 상세 조회 | 개별 쿠폰 정보 | Medium |
| F-203 | 이벤트 목록 | 진행중/예정/종료 이벤트 | High |
| F-204 | 이벤트 상세 | 이벤트 정보 및 잔여 수량 | High |

#### 3.1.4 실시간 알림
| 기능 ID | 기능명 | 설명 | 우선순위 |
|---------|--------|------|----------|
| F-301 | WebSocket 연결 | 실시간 통신 채널 수립 | High |
| F-302 | 발급 성공 알림 | 쿠폰 발급 성공 즉시 알림 | High |
| F-303 | 발급 실패 알림 | 품절/제한 초과 시 알림 | High |
| F-304 | 연결 상태 관리 | 재연결, Heartbeat | Medium |

---

### 3.2 Phase 2 - 확장 기능 (선택)

#### 3.2.1 고급 알림
| 기능 ID | 기능명 | 설명 | 우선순위 |
|---------|--------|------|----------|
| F-401 | 사전 알림 | 이벤트 시작 10분 전 알림 | Low |
| F-402 | 품절 알림 | 쿠폰 소진 시 대기자 알림 | Low |
| F-403 | 관심 이벤트 등록 | 맞춤 알림 설정 | Low |

#### 3.2.2 쿠폰 사용
| 기능 ID | 기능명 | 설명 | 우선순위 |
|---------|--------|------|----------|
| F-501 | 쿠폰 사용 | 쿠폰 사용 처리 | Low |
| F-502 | 쿠폰 취소 | 미사용 쿠폰 취소 | Low |
| F-503 | 유효기간 관리 | 자동 만료 처리 | Low |

#### 3.2.3 관리자 기능
| 기능 ID | 기능명 | 설명 | 우선순위 |
|---------|--------|------|----------|
| F-601 | 이벤트 등록 | 새 쿠폰 이벤트 생성 | Medium |
| F-602 | 발급 현황 모니터링 | 실시간 발급 통계 | Medium |
| F-603 | 대시보드 | 전체 통계 및 지표 | Low |

---

## 4. 비기능 요구사항

### 4.1 보안 요구사항
- JWT 기반 인증/인가
- HTTPS 통신 강제
- SQL Injection 방어
- Rate Limiting 적용
- 민감 정보 암호화 (비밀번호)

### 4.2 안정성 요구사항
- 트랜잭션 ACID 보장
- 분산 락을 통한 데이터 정합성
- 장애 격리 (Circuit Breaker)
- Graceful Shutdown

### 4.3 모니터링 요구사항
- 실시간 메트릭 수집 (Prometheus)
- 시각화 대시보드 (Grafana)
- 로그 중앙화 (ELK Stack 또는 CloudWatch)
- Alert 설정 (CPU, Memory, Error Rate)

### 4.4 테스트 요구사항
- 단위 테스트 커버리지 70% 이상
- 통합 테스트 작성
- 부하 테스트 (JMeter)
- 카오스 엔지니어링 (선택)

---

## 5. 시스템 제약사항

### 5.1 기술 제약
- Java 17 이상
- Node.js 18 이상
- PostgreSQL 15 이상
- Redis 7 이상

### 5.2 인프라 제약
- 로컬: 라즈베리파이 5 (개발/테스트)
- 클라우드: AWS 프리티어 범위 내

### 5.3 개발 제약
- 1인 개발
- 개발 기간: 4-6주

---

## 6. 사용자 스토리

### 6.1 사용자 관점

**US-001: 쿠폰 발급받기**
```
As a 사용자
I want to 선착순 쿠폰을 빠르게 발급받고 싶다
So that 할인 혜택을 받을 수 있다

Acceptance Criteria:
- 버튼 클릭 후 1초 이내 결과 확인
- 성공/실패 즉시 알림 수신
- 발급 내역 즉시 반영
```

**US-002: 내 쿠폰 관리**
```
As a 사용자
I want to 발급받은 쿠폰을 한눈에 보고 싶다
So that 쿠폰 사용 계획을 세울 수 있다

Acceptance Criteria:
- 사용 가능/사용 완료/만료 구분
- 유효기간 표시
- 쿠폰 코드 복사 가능
```

### 6.2 관리자 관점

**US-101: 이벤트 생성**
```
As a 관리자
I want to 새로운 쿠폰 이벤트를 등록하고 싶다
So that 사용자에게 프로모션을 제공할 수 있다

Acceptance Criteria:
- 이벤트명, 수량, 기간 설정
- 발급 조건 설정 (1인당 제한)
- 즉시 활성화 또는 예약 가능
```

---

## 7. 우선순위 및 일정

### 7.1 개발 우선순위

**P0 (필수):**
- 회원 인증 (F-001, F-002)
- 선착순 쿠폰 발급 (F-101~F-105)
- 실시간 알림 (F-301~F-303)
- 쿠폰 조회 (F-201, F-203, F-204)

**P1 (중요):**
- 프로필 관리 (F-003, F-004)
- 쿠폰 상세 조회 (F-202)
- WebSocket 안정성 (F-304)
- 관리자 이벤트 등록 (F-601)

**P2 (선택):**
- 사전 알림 (F-401~F-403)
- 쿠폰 사용 (F-501~F-503)
- 대시보드 (F-603)

### 7.2 개발 일정

| Week | Phase | 주요 작업 |
|------|-------|----------|
| 1-2 | 기반 구축 | 인프라 세팅, 기본 API, 인증 |
| 3-4 | 핵심 기능 | 쿠폰 발급, 동시성 제어, 알림 |
| 5-6 | 고도화 | 부하 테스트, 모니터링, 배포 |

---

## 8. 성공 지표

### 8.1 기술적 성공 지표
- ✅ 동시 1만명 부하 테스트 통과
- ✅ 응답 시간 500ms 이하 달성
- ✅ 발급 성공률 99% 이상
- ✅ Zero Downtime 배포

### 8.2 학습 목표 달성
- ✅ MSA 아키텍처 경험
- ✅ Redis 동시성 제어 구현
- ✅ WebSocket 실시간 통신
- ✅ 대용량 트래픽 처리 기법
- ✅ 모니터링 시스템 구축

---

## 9. 위험 요소 및 대응

| 위험 | 영향도 | 발생 가능성 | 대응 방안 |
|------|--------|-------------|-----------|
| 동시성 이슈 | High | High | Redis 분산 락, 재시도 로직 |
| WebSocket 연결 끊김 | Medium | Medium | 자동 재연결, Fallback |
| DB 병목 | High | Medium | Redis 캐싱, 읽기 전용 복제 |
| 인프라 비용 초과 | Low | Low | AWS 프리티어 모니터링 |

---

## 10. 참고 자료

- [Redis 분산 락 패턴](https://redis.io/docs/manual/patterns/distributed-locks/)
- [Spring Boot WebSocket](https://spring.io/guides/gs/messaging-stomp-websocket/)
- [Socket.io Documentation](https://socket.io/docs/)
- [RabbitMQ Tutorials](https://www.rabbitmq.com/getstarted.html)

---

**문서 버전:** 1.0  
**최종 수정일:** 2026-02-11  
**작성자:** gyrms
